=============================
 مشروع صفحة تصيّد توعوي (Flask)
=============================

Gophishهذا المشروع يمثل صفحة تسجيل دخول وهمية مرتبطة بأداة 
وعند إدخال البيانات، تُسجل في قاعدة بيانات ويُنقل الضحية إلى صفحة توعية

-----------------------------
1. طريقة تشغيل المشروع
-----------------------------
1. تأكد من وجود Python 3.8 أو أحدث.
2. شغّل هذه الأوامر في الطرفية:

   python -m venv venv
   source venv/bin/activate   ← أو على Windows: venv\Scripts\activate
   pip install -r requirements.txt  # أو pip install flask sqlalchemy requests

3. لتشغيل المشروع:

   python run_with_ngrok.py

4. سيفتح على الرابط:
   http://localhost:5000/
   أو من جهاز آخر داخل الشبكة:
   http://<IP-Address>:5000/

-----------------------------
2. ربط Gophish مع الصفحة
-----------------------------
- **Landing Page**: عند إنشاء حملة في Gophish ضع الرابط:
https://<ngrok-url>/login?e={{.Email}}

https://90c0aaa10b3c.ngrok-free.app/login?e={{.Email}}


- **Webhook**: لإرسال البيانات مباشرةً إلى Flask بدلاً من الاحتفاظ بها في Gophish:
1. في صفحة Webhook داخل Gophish ضع:
   - **URL**: 
     ```
     https://<ngrok-url>/gophish/webhook
     ```
   - **Name** و **Secret**: يمكن تركها فارغة
2. لا حاجة لتغيير أي شيء عند إنشاء الحملة بعد إعداد Webhook، تابع نفس الطريقة المعتادة.

> الآن كل البيانات التي يدخلها الضحايا (البريد، الاسم، الجوال) سيتم حفظها مباشرة في قاعدة بيانات Flask.

-----------------------------
3. تعديل تصميم login.html
-----------------------------
لو أردت وضع تصميم جديد لصفحة `login.html`:

1. استخرج الكود من `<body>...</body>` فقط.
2. انسخه داخل ملف:
templates/login.html

3. تأكد من:
- وجود `<form method="POST" action="/submit_credentials">`
- وجود حقول `input name="username"`, `input name="email"`, `input name="phone"`

-----------------------------
4. تحديث قاعدة البيانات (إضافة العمود phone)
-----------------------------
بعد أول تشغيل للمشروع، إذا ظهرت مشكلة أن العمود `phone` غير موجود في قاعدة البيانات، شغّل:

python scripts/update-phone.py

سيقوم هذا السكربت بإضافة العمود `phone` إلى جدول الضحايا وتعبئة القيم الفارغة بـ "غير متوفر".

-----------------------------
5. إنشاء حساب المشرف
-----------------------------
قبل الدخول إلى لوحة التحكم، يجب إنشاء حساب مشرف. استخدم سكربت `create_admin.py`:

   python create_admin.py

- سيطلب منك إدخال:
  - اسم المستخدم للمشرف
  - كلمة المرور للمشرف
- إذا كان المشرف موجود مسبقًا، لن يتم إنشاءه مرة أخرى.
- بعد نجاح العملية، يمكن تسجيل الدخول بلوحة التحكم باستخدام الحساب الجديد.
